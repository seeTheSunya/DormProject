<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³„ì • ì°¾ê¸° - ë„ë€</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100">
    <div id="app" class="flex items-center justify-center min-h-screen">
        <div class="bg-white p-8 rounded-lg shadow-xl w-96">
            <h1 class="text-2xl font-bold text-center text-gray-800 mb-6">ğŸ” ê³„ì • ì°¾ê¸°</h1>

            <!-- íƒ­ ë²„íŠ¼ -->
            <div class="flex border-b border-gray-200 mb-6">
                <button @click="mode = 'id'" :class="mode === 'id' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'" class="w-1/2 py-2 text-center border-b-2 font-medium transition">ì•„ì´ë”” ì°¾ê¸°</button>
                <button @click="mode = 'pw'" :class="mode === 'pw' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700'" class="w-1/2 py-2 text-center border-b-2 font-medium transition">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</button>
            </div>

            <!-- ì•„ì´ë”” ì°¾ê¸° í¼ -->
            <div v-if="mode === 'id'">
                <p class="text-sm text-gray-600 mb-4">ê°€ì… ì‹œ ì…ë ¥í•œ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
                <input type="email" v-model="idEmail" placeholder="ì´ë©”ì¼" class="w-full border p-2 rounded mb-4 focus:ring-2 focus:ring-blue-500 outline-none">
                <button @click="findId" class="w-full bg-blue-600 text-white font-bold py-2 rounded hover:bg-blue-700 mb-3">ì•„ì´ë”” ì°¾ê¸°</button>
            </div>

            <!-- ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸° í¼ -->
            <div v-else>
                <p class="text-sm text-gray-600 mb-4">ì•„ì´ë””ì™€ ì´ë©”ì¼ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.</p>
                <input type="text" v-model="pwUsername" placeholder="ì•„ì´ë””" class="w-full border p-2 rounded mb-2 focus:ring-2 focus:ring-blue-500 outline-none">
                <input type="email" v-model="pwEmail" placeholder="ì´ë©”ì¼" class="w-full border p-2 rounded mb-4 focus:ring-2 focus:ring-blue-500 outline-none">
                <button @click="findPassword" class="w-full bg-blue-600 text-white font-bold py-2 rounded hover:bg-blue-700 mb-3">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</button>
            </div>

            <!-- ê²°ê³¼ ë©”ì‹œì§€ -->
            <div v-if="message" class="mt-4 p-3 bg-gray-50 rounded text-center text-sm font-semibold" :class="isError ? 'text-red-500' : 'text-blue-600'">
                {{ message }}
            </div>

            <div class="mt-6 text-center">
                <a href="login.html" class="text-sm text-gray-500 hover:underline">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    mode: 'id', // 'id' or 'pw'
                    idEmail: '',
                    pwUsername: '',
                    pwEmail: '',
                    message: '',
                    isError: false
                }
            },
            methods: {
                async findId() {
                    if (!this.idEmail) return alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    this.message = "ì°¾ëŠ” ì¤‘...";
                    this.isError = false;
                    try {
                        const res = await axios.post('http://localhost:8080/api/find-id', { email: this.idEmail });
                        this.message = `íšŒì›ë‹˜ì˜ ì•„ì´ë””ëŠ” [ ${res.data} ] ì…ë‹ˆë‹¤.`;
                    } catch (e) {
                        this.isError = true;
                        this.message = e.response && e.response.data ? e.response.data : "ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                    }
                },
                async findPassword() {
                    if (!this.pwUsername || !this.pwEmail) return alert("ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    this.message = "ì°¾ëŠ” ì¤‘...";
                    this.isError = false;
                    try {
                        const res = await axios.post('http://localhost:8080/api/find-password', { 
                            username: this.pwUsername, 
                            email: this.pwEmail 
                        });
                        this.message = `íšŒì›ë‹˜ì˜ ë¹„ë°€ë²ˆí˜¸ëŠ” [ ${res.data} ] ì…ë‹ˆë‹¤.`;
                    } catch (e) {
                        this.isError = true;
                        this.message = e.response && e.response.data ? e.response.data : "ì •ë³´ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
                    }
                }
            }
        }).mount('#app');
    </script>
</body>
</html>